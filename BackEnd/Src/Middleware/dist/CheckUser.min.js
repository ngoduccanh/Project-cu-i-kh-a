"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _User=_interopRequireDefault(require("../Model/User.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var CheckUser=function(r,t,n){var a,u,s,o,i,c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.headers.authorization){e.next=3;break}return e.abrupt("return",t.status(401).json({message:"Tài khoản chưa được cung cấp"}));case 3:if(2!==(u=a.split(" ")).length||"Bearer"!==u[0])return e.abrupt("return",t.status(401).json({error:"apiKey không đúng định dạng"}));e.next=6;break;case 6:if(s=u[1],4!==(o=s.split("-")).length||"mern"!==o[0])return e.abrupt("return",t.status(401).json({error:"apiKey không đúng định dạng"}));e.next=10;break;case 10:return i=o[1],e.prev=11,e.next=14,regeneratorRuntime.awrap(_User.default.findById(i));case 14:if(c=e.sent){e.next=17;break}return e.abrupt("return",t.status(401).json({error:"apiKey không hợp lệ hoặc user không tồn tại"}));case 17:r.user=c,n(),e.next=25;break;case 21:return e.prev=21,e.t0=e.catch(11),console.error(e.t0),e.abrupt("return",t.status(500).json({error:"Lỗi hệ thống khi xác thực apiKey"}));case 25:case"end":return e.stop()}},null,null,[[11,21]])},_default=CheckUser;exports.default=_default;
//# sourceMappingURL=CheckUser.min.js.map
